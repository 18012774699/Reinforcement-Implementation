This is copied from https://github.com/Kaixhin/Rainbow.

I verified the performance.